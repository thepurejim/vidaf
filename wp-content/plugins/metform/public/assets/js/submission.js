var onloadMetFormCallback=function(){jQuery(".recaptcha_site_key").each(function(e){var t=jQuery(this),a=t.parents(".metform-form-content");void 0!==a.data("site-key")&&""!=a.data("site-key")&&(t.attr("id",t.attr("id")+"_"+e),grecaptcha.render("recaptcha_site_key_"+e,{sitekey:a.data("site-key")}))})};function metformSubmision(e){var t;(t=jQuery).validator.addMethod("regx",function(e,t,a){return new RegExp(a).test(e)},t.validator.format("Please match the expression {0}")),t.validator.addMethod("wordLength",function(e,t,a){var i=e.trim().split(/\s+/),n=a.min,s=a.max;return!n&&s&&(n=1),i.filter(()=>i.length>=n&&(!s||i.length<=s)).length},t.validator.format("Please match word length.")),jQuery.validator.addMethod("ratingValidate",function(e,a,i){return!t(a).prop("required")||t(a).parents(".mf-input-wrapper").find(".mf-input-rating li.selected").length},t.validator.format(mf_submission.default_required_message)),t.validator.addClassRules(".mf-input",{required:!0}),t(document).on("validation.mfForm",function(e,a){t(a).validate({ignore:[],rules:{"mf-rating":{ratingValidate:!0}},errorPlacement:function(e,t){t.parents(".mf-input-wrapper").append(e)},highlight:function(e){t(e).parents(".mf-input-wrapper").addClass("mf-field-error")},unhighlight:function(e){t(e).parents(".mf-input-wrapper").removeClass("mf-field-error")}}),t(a).find(".mf-input-do-validate").each(function(){var e=t(this).data("validation"),a=t(this).attr("min"),i=t(this).attr("max"),n={messages:{required:mf_submission.default_required_message,email:mf_submission.default_required_message,url:mf_submission.default_required_message,range:mf_submission.default_required_message,max:mf_submission.default_required_message,min:mf_submission.default_required_message}};void 0!==e&&""!=e&&("none"!==e.validation_type&&(n.required=!0,n.messages.required=e.warning_message),"by_character_length"===e.validation_type?(e.min_length&&(n.minlength=e.min_length,n.messages.minlength=e.warning_message),e.max_length&&(n.maxlength=e.max_length,n.messages.maxlength=e.warning_message),n.messages.email=e.warning_message):"by_word_length"===e.validation_type?(n.wordLength={},n.messages.wordLength=e.warning_message,e.min_length&&(n.wordLength.min=e.min_length),e.max_length&&(n.wordLength.max=e.max_length),n.messages.email=e.warning_message):"by_expresssion_based"===e.validation_type&&(n.messages.regx=e.warning_message,e.expression&&t(this).rules("add",{regx:e.expression}),n.messages.email=e.warning_message)),(a||i)&&(n.range=[a,i]),n.required=!0,t(this).rules("add",n)})}),t(document).on("submit",".metform-form-content",async function(e){e.preventDefault();var a=t(this);if(t(document).trigger("validation.mfForm",t(this)),t(this).valid()&&!t(this).hasClass("mf-form-submitting")){var i=t(this),n="";i.find('.mf-input[type="tel"]').each(function(){var e,a=t(this),i=a.val();e=a.siblings(".iti__flag-container").find(".iti__selected-dial-code").text(),a.val(e+i)}),i.find(".g-recaptcha-response-v3").length&&(n="undefined"!=grecaptcha?await grecaptcha.execute(i.data("site-key"),{action:"mf_recaptcha_v3"}):"",i.find(".g-recaptcha-response-v3").val(n));var s=i.parent().find(".metform-msg"),r=i.attr("action"),o=new FormData(this),d=i.attr("data-nonce");s.length>1&&i.parent().find(".metform-inx").remove(),t.ajax({url:r,type:"POST",dataType:"JSON",data:o,processData:!1,contentType:!1,headers:{"X-WP-Nonce":d},beforeSend:function(){a.addClass("mf-form-submitting")},success:function(e){var n=Number(e.status),r="";if(t.each(e.error,function(e,t){r+=t+"<br>"}),r.replace(/<br>+$/,""),1==n?(s.css("display","block"),s.removeClass("attr-alert-warning"),s.addClass("attr-alert-success"),s.html(e.data.message),setTimeout(function(){s.css("display","none")},8e3),i.trigger("reset"),i.find(".metform-step-item").removeClass("active prev next").first().addClass("active").next().addClass("next"),i.find(".elementor-top-section").first().addClass("active").find(".metform-btn").attr("type","submit").end().siblings().removeClass("active"),i.find(".elementor-section-wrap").css({transform:"translateX(0)"}),i.find(".mf-input-select, .mf-input-multiselect").trigger("change"),i.find(".mf-input-rating > li").removeClass("selected").first().addClass("selected"),i.find(".mf-input-rating").next().val("").trigger("change"),i.find(".mf-input-file-upload").val("").parent().find(".mf-file-name span").html("No file chosen."),i.find(".mf-input-like-dislike").val("").trigger("change"),i.find(".mf-parent-like-dislike a").removeClass("green").removeClass("red"),i.find(".asRange > .asRange-pointer").css("left","0%"),i.find(".asRange > .asRange-selected").css({left:"0%",width:"0%"}),i.find(".mf-refresh-captcha").trigger("click")):(s.css("display","block"),s.removeClass("attr-alert-success"),s.addClass("attr-alert-warning"),s.html(r),setTimeout(function(){s.css("display","none")},8e3)),1==n&&""!=e.data.hide_form&&setTimeout(function(){i.css("display","none")},2e3),"stripe"==e.data.store["mf-payment-method"]){if(res=e.data.payment_data,!res.keys||""==res.keys)return void alert("Please set your Stripe Keys in form settings.");var o=StripeCheckout.configure({key:res.keys,image:res.image_url,locale:"auto",token:function(t){if(t.id){res.stripe_token=t.id;var a={sandbox:res.sandbox};jQuery.ajax({data:a,type:"get",url:e.data.ajax_stripe+"&token="+t.id,headers:{"X-WP-Nonce":d},success:function(e){e.status?(console.log(e.redirect_url),window.location.href=e.redirect_url):alert(e)}})}else alert("Sorry!! Payment token invalid")}});return o.open({name:String(res.name_post),description:" Form No.: "+String(res.description),amount:100*Number(res.amount),currency:res.currency_code}),void window.addEventListener("popstate",function(){o.close()})}1==n&&""!=e.data.redirect_to&&setTimeout(function(){window.location.href=e.data.redirect_to},1500),a.removeClass("mf-form-submitting")}})}})}jQuery(document).ready(function(e){(e("body").hasClass("single-metform-form")||e(".mf-form-shortcode").length)&&void 0!==metformSubmision&&metformSubmision()});